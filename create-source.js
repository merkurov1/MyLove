require('dotenv').config({ path: '.env.local' })
const { createClient } = require('@supabase/supabase-js')

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL
const supabaseKey = process.env.SUPABASE_SERVICE_ROLE_KEY

if (!supabaseUrl || !supabaseKey) {
  console.error('âŒ ÐžÑ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‚ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ SUPABASE')
  console.log('NEXT_PUBLIC_SUPABASE_URL:', !!supabaseUrl)
  console.log('SUPABASE_SERVICE_ROLE_KEY:', !!supabaseKey)
  process.exit(1)
}

const supabase = createClient(supabaseUrl, supabaseKey)

async function createDefaultSource() {
  console.log('ðŸ”§ Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ...')

  const { data, error } = await supabase
    .from('sources')
    .upsert({
      id: 'c5aab739-7112-4360-be9e-45edf4287c42',
      name: 'ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº',
      description: 'ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð² Ð´Ð»Ñ AI-Ð°ÑÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð°'
    })
    .select()

  if (error) {
    console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ°:', error)
    return false
  }

  console.log('âœ… Ð˜ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº ÑÐ¾Ð·Ð´Ð°Ð½:', data)
  return true
}

createDefaultSource().then(() => {
  console.log('ðŸŽ‰ Ð“Ð¾Ñ‚Ð¾Ð²Ð¾!')
})