# üé≠ Pierrot AI

> **–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç—ã —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ –Ω–∞ –±–∞–∑–µ RAG (Retrieval-Augmented Generation)**

–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–æ–≤, –ø—Å–∏—Ö–æ–ª–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –∏ —Ä–∞–±–æ—Ç—ã —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫, LLM –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞.

üåê **Live Demo**: [pierrot.merkurov.love](https://pierrot.merkurov.love)  
ÔøΩ **Promo Page**: [pierrot.merkurov.love/ai](https://pierrot.merkurov.love/ai)

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üîç –£–º–Ω—ã–π –ø–æ–∏—Å–∫

- **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫** –ø–æ —Å–µ–º–∞–Ω—Ç–∏–∫–µ, –∞ –Ω–µ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
- **–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫** (30% –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ + 70% —Å–µ–º–∞–Ω—Ç–∏–∫–∞) –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏
- **HNSW –∏–Ω–¥–µ–∫—Å** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ 1536-–º–µ—Ä–Ω—ã–º –≤–µ–∫—Ç–æ—Ä–∞–º OpenAI
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–æ–≤

### üí¨ –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π —á–∞—Ç

- **GPT-4o-mini** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ —Å –Ω–∏–∑–∫–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–∏–π**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç —Ç–∏–ø –∑–∞–ø—Ä–æ—Å–∞ (–∞–Ω–∞–ª–∏–∑, —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ, Q&A)
- **–¶–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤** —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ –ø—Ä—è–º—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏
- **–ò—Å—Ç–æ—Ä–∏—è —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤** —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –¥–∏–∞–ª–æ–≥
- **Markdown-—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥** –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤

### üìö –†–∞–±–æ—Ç–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤: `.txt`, `.docx` (—á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫—É mammoth)
- –£–º–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ —á–∞–Ω–∫–∏ (–¥–æ 2000 —Å–∏–º–≤–æ–ª–æ–≤ —Å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º 200)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –æ—Ç —Å–ª—É–∂–µ–±–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –∏ null bytes
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è embeddings —á–µ—Ä–µ–∑ OpenAI text-embedding-3-small (1536d)
- Full-text search —á–µ—Ä–µ–∑ PostgreSQL tsvector (—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫)

### üß† –ì–ª—É–±–æ–∫–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è:

- **–ü—Å–∏—Ö–æ–ª–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑**: —è–∑—ã–∫–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–æ–Ω, —Ä–∏—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏—ë–º—ã
- **–ü—Ä–æ—Ñ–∞–π–ª–∏–Ω–≥ –∞–≤—Ç–æ—Ä–∞**: –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–π —Å—Ç–∏–ª—å, –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—Ç—Ä–µ—Ç, –º–æ—Ç–∏–≤–∞—Ü–∏—è
- **–ê–Ω–∞–ª–∏–∑ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏**: —Ç–∏–ø—ã –¥–∏—Å–∫—É—Ä—Å–∞, –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
- **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**: –≤—ã—è–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ç–∏–ª–µ –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–∏

### üí∞ –ë—é–¥–∂–µ—Ç-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

- **$0.78/–º–µ—Å—è—Ü** –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ (–æ–¥–Ω–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º)
- –£—Å–ª–æ–≤–Ω—ã–π reranking —á–µ—Ä–µ–∑ LLM (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ similarity < 0.5)
- –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –±–∞—Ç—á–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤



---

## üèóÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Frontend

- **Next.js 14.2** (App Router, React Server Components)
- **TypeScript** –¥–ª—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **Tailwind CSS** + **@tailwindcss/typography** –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏
- **react-markdown** + **remark-gfm** –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ Markdown
- **React Icons** –¥–ª—è UI —ç–ª–µ–º–µ–Ω—Ç–æ–≤

### Backend

- **Node.js runtime** (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å OpenAI SDK)
- **Vercel AI SDK** (@ai-sdk/openai) –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å embeddings
- **Next.js API Routes** –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –ª–æ–≥–∏–∫–∏

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

- **Supabase PostgreSQL** —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º **pgvector**
- **HNSW –∏–Ω–¥–µ–∫—Å** –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ 32MB maintenance_work_mem)
- **tsvector** –¥–ª—è full-text search –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- –•—Ä–∞–Ω–∏–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã: `match_documents`, `hybrid_search`

### AI/ML

- **OpenAI GPT-4o-mini** ($0.60/–º–µ—Å—è—Ü –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏)
- **OpenAI text-embedding-3-small** (1536 —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π, $0.03 –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ)
- **Vercel AI SDK** –¥–ª—è streamline –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### Deployment

- **Vercel** –¥–ª—è —Ö–æ—Å—Ç–∏–Ω–≥–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è
- **GitHub Actions** –¥–ª—è CI/CD
- **Environment variables** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–ª—é—á–µ–π

---

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     Client (Browser)                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  ‚îÇ ChatAssistant‚îÇ  ‚îÇ FileUploader ‚îÇ  ‚îÇ   Sidebar    ‚îÇ      ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                             ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   Next.js API Routes                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  ‚îÇ  /api/chat   ‚îÇ  ‚îÇ /api/ingest  ‚îÇ  ‚îÇ/api/conversations‚îÇ  ‚îÇ
‚îÇ  ‚îÇ              ‚îÇ  ‚îÇ              ‚îÇ  ‚îÇ              ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Intent     ‚îÇ  ‚îÇ ‚Ä¢ Mammoth    ‚îÇ  ‚îÇ ‚Ä¢ History    ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Vector     ‚îÇ  ‚îÇ ‚Ä¢ Chunking   ‚îÇ  ‚îÇ ‚Ä¢ Messages   ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ LLM        ‚îÇ  ‚îÇ ‚Ä¢ Embeddings ‚îÇ  ‚îÇ              ‚îÇ      ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                             ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  Supabase PostgreSQL                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ documents (title, description, source_url)           ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ document_chunks (content, embedding vector(1536))    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ conversations (title, created_at, updated_at)        ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ messages (role, content, metadata)                   ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ RPC Functions:                                       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ match_documents(vector(1536), int)                 ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ hybrid_search(text, vector(1536), int, float)      ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ Indexes:                                             ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ HNSW (m=16, ef_construction=64)                    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ GIN (content_tsv) for full-text search             ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                             ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      OpenAI API                              ‚îÇ
‚îÇ  ‚Ä¢ text-embedding-3-small (1536d)                            ‚îÇ
‚îÇ  ‚Ä¢ gpt-4o-mini (128K context)                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 18+
- Supabase –∞–∫–∫–∞—É–Ω—Ç
- OpenAI API –∫–ª—é—á

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/merkurov1/MyLove.git
cd MyLove
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.env.local`:

```env
# OpenAI
OPENAI_API_KEY=sk-proj-...

# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJ...
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJ...

# Optional
DEFAULT_SOURCE_ID=c5aab739-7112-4360-be9e-45edf4287c42
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç—ã –≤ Supabase SQL Editor –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ:

1. **COMPLETE_FIX.sql** - —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
2. **FIX_MESSAGES_TABLE.sql** - —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–æ–≤
3. **REINDEX_VECTORS.sql** - –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã

```bash
# –°–∫—Ä–∏–ø—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
cat COMPLETE_FIX.sql
cat FIX_MESSAGES_TABLE.sql
cat REINDEX_VECTORS.sql
```

### 4. –ó–∞–ø—É—Å–∫ –≤ development —Ä–µ–∂–∏–º–µ

```bash

npm run dev
```

–û—Ç–∫—Ä–æ–π—Ç–µ [http://localhost:3000](http://localhost:3000)

### 5. –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–≤–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞

1. –ù–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç"
2. –í—ã–±–µ—Ä–∏—Ç–µ `.txt` –∏–ª–∏ `.docx` —Ñ–∞–π–ª
3. –î–æ–∂–¥–∏—Ç–µ—Å—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ (—Å–æ–∑–¥–∞–Ω–∏–µ —á–∞–Ω–∫–æ–≤ + –≥–µ–Ω–µ—Ä–∞—Ü–∏—è embeddings)
4. –ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –≤ —á–∞—Ç–µ!

---

## üìñ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ—Å—Ç–æ–π Q&A
```
Q: –û —á–µ–º –ø–æ—Å–ª–µ–¥–Ω—è—è –∫–æ–ª–æ–Ω–∫–∞ –≤ –ù–æ–≤–æ–π –ì–∞–∑–µ—Ç–µ?
A: [–û—Ç–≤–µ—Ç —Å —Ü–∏—Ç–∞—Ç–∞–º–∏ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏ —É–∫–∞–∑–∞–Ω–∏–µ–º —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏]
```

### –ü—Å–∏—Ö–æ–ª–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
```
Q: –°–¥–µ–ª–∞–π –ø—Å–∏—Ö–æ–ª–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–ª–æ–Ω–∫–∏ –æ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–µ –ó–æ—Å–∏–º–∞

A: [–ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å 5 —É—Ä–æ–≤–Ω—è–º–∏]
   1. –ö–æ–Ω—Ç–µ–Ω—Ç-–∞–Ω–∞–ª–∏–∑
   2. –ü—Å–∏—Ö–æ–ª–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
   3. –ü—Ä–æ—Ñ–∞–π–ª–∏–Ω–≥ –∞–≤—Ç–æ—Ä–∞
   4. –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
   5. –ò–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω—ã–µ –≤—ã–≤–æ–¥—ã
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
```
Q: –°—Ä–∞–≤–Ω–∏ —Ä–∏—Ç–æ—Ä–∏–∫—É –≤ –¥–≤—É—Ö –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö

A: [–î–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–∏–ª–∏—Å—Ç–∏–∫–∏, –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ü–∏–∏, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–æ–Ω–∞]
```

### –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ñ–∞–∫—Ç–æ–≤
```
Q: Who is Anton Merkurov?

A: Anton Merkurov is an Armenian-Jewish artist, internet expert, 
   and great-grandson of famous Soviet sculptor Sergey Merkurov...
   [+ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å—é 50-54%]
```

---

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
MyLove/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ chat/route.ts          # –û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç endpoint
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ingest/route.ts        # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ conversations/route.ts # –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ documents/route.ts     # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ stats/route.ts         # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx                 # Root layout
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx                   # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ ChatAssistant.tsx          # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —á–∞—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ FileUploader.tsx           # –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ Sidebar.tsx                # –ò—Å—Ç–æ—Ä–∏—è —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ agent-actions.ts           # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ chunking.ts                # –†–∞–∑–±–∏–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ embedding-ai.ts            # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è embeddings
‚îÇ   ‚îî‚îÄ‚îÄ reranking.ts               # LLM reranking
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ supabase/
‚îÇ       ‚îú‚îÄ‚îÄ client.ts              # Client-side Supabase
‚îÇ       ‚îî‚îÄ‚îÄ server.ts              # Server-side Supabase
‚îú‚îÄ‚îÄ COMPLETE_FIX.sql               # –û—Å–Ω–æ–≤–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –ë–î
‚îú‚îÄ‚îÄ FIX_MESSAGES_TABLE.sql         # –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–æ–≤
‚îú‚îÄ‚îÄ REINDEX_VECTORS.sql            # –í–µ–∫—Ç–æ—Ä–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã
‚îî‚îÄ‚îÄ package.json
```

### –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã

#### `app/api/chat/route.ts`
–û—Å–Ω–æ–≤–Ω–æ–π endpoint —á–∞—Ç–∞. –õ–æ–≥–∏–∫–∞:
1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–∏—è (intent detection)
2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è embedding –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞
3. –í–µ–∫—Ç–æ—Ä–Ω—ã–π/–≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫
4. Conditional reranking (–µ—Å–ª–∏ similarity < 0.5)
5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ GPT-4o-mini
6. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ conversations/messages

#### `lib/embedding-ai.ts`
–£–º–Ω—ã–π –±–∞—Ç—á–∏–Ω–≥ –¥–ª—è OpenAI embeddings:
- MAX_TOKENS_PER_TEXT = 2000
- MAX_TOKENS_PER_BATCH = 6000
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ oversized —Ç–µ–∫—Å—Ç–æ–≤
- –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

#### `lib/chunking.ts`
–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–∑–±–∏–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞:
- maxChunkSize = 2000 —Å–∏–º–≤–æ–ª–æ–≤ (~500 —Ç–æ–∫–µ–Ω–æ–≤)
- overlapSize = 200 —Å–∏–º–≤–æ–ª–æ–≤
- Force character-based split –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤ –±–µ–∑ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏

---

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ú–µ—Ç—Ä–∏–∫–∏ (–Ω–∞ ~200 –¥–æ–∫—É–º–µ–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–∞—Ö)

| –û–ø–µ—Ä–∞—Ü–∏—è | –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è | –°—Ç–æ–∏–º–æ—Å—Ç—å |
|----------|---------------|-----------|
| Vector search | 50-150ms | $0 |
| Embedding generation | 200-500ms | $0.0001 |
| LLM response (GPT-4o-mini) | 1-3s | $0.003 |
| Reranking (conditional) | +500ms | $0.001 |
| **–ü–æ–ª–Ω—ã–π –∑–∞–ø—Ä–æ—Å** | **2-4s** | **$0.004** |

### –ë—é–¥–∂–µ—Ç –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏

- **200 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü**: $0.80
- **500 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü**: $2.00
- **1000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü**: $4.00

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: 
- Conditional reranking —ç–∫–æ–Ω–æ–º–∏—Ç ~40% –±—é–¥–∂–µ—Ç–∞
- HNSW –∏–Ω–¥–µ–∫—Å –±—ã—Å—Ç—Ä–µ–µ IVFFlat –Ω–∞ 2-3x
- –ë–∞—Ç—á–∏–Ω–≥ embeddings —Å–Ω–∏–∂–∞–µ—Ç latency –Ω–∞ 50%

---

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: "memory required is 59 MB, maintenance_work_mem is 32 MB"
**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HNSW –∏–Ω–¥–µ–∫—Å –≤–º–µ—Å—Ç–æ IVFFlat:
```sql
CREATE INDEX document_chunks_embedding_idx ON document_chunks 
  USING hnsw (embedding vector_cosine_ops)
  WITH (m = 16, ef_construction = 64);
```

### –ü—Ä–æ–±–ª–µ–º–∞: –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –Ω–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
**–†–µ—à–µ–Ω–∏–µ**: –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –∏–Ω–¥–µ–∫—Å –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (—Å–º. `REINDEX_VECTORS.sql`)

### –ü—Ä–æ–±–ª–µ–º–∞: "column messages.role does not exist"
**–†–µ—à–µ–Ω–∏–µ**: –í—ã–ø–æ–ª–Ω–∏—Ç–µ `FIX_MESSAGES_TABLE.sql` –¥–ª—è –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

### –ü—Ä–æ–±–ª–µ–º–∞: PostgreSQL "22P05: unsupported Unicode escape sequence"
**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `cleanTextForPostgres()` –∏–∑ `app/api/ingest/route.ts` –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è null bytes

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ Service role key –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¢–û–õ–¨–ö–û –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚úÖ Anon key –¥–ª—è client-side –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ Row Level Security (RLS) –Ω–∞ —Ç–∞–±–ª–∏—Ü–∞—Ö Supabase
- ‚úÖ Environment variables —á–µ—Ä–µ–∑ `.env.local` (–Ω–µ –≤ git)
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è production –¥–æ–º–µ–Ω–∞

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [COMPLETE_FIX.sql](./COMPLETE_FIX.sql) - –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- [FIX_README.md](./FIX_README.md) - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é –±–∞–≥–æ–≤
- [DATABASE_MANAGEMENT.md](./DATABASE_MANAGEMENT.md) - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ë–î
- [ADVANCED_QUERIES_EXAMPLES.md](./ADVANCED_QUERIES_EXAMPLES.md) - –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

---

## ü§ù Contributing

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è –ª–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –Ω–æ –µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∏–¥–µ–∏:

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞–π—Ç–µ feature branch (`git checkout -b feature/amazing-feature`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏–π (`git commit -m 'Add amazing feature'`)
4. Push –≤ branch (`git push origin feature/amazing-feature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. [LICENSE](./LICENSE)

---

## üë§ –ê–≤—Ç–æ—Ä

**Anton Merkurov**

- Website: [merkurov.love](https://merkurov.love)
- Email: merkurov@gmail.com
- GitHub: [@merkurov1](https://github.com/merkurov1)

---

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- [OpenAI](https://openai.com) –∑–∞ GPT-4o-mini –∏ text-embedding-3-small
- [Vercel](https://vercel.com) –∑–∞ AI SDK –∏ —Ö–æ—Å—Ç–∏–Ω–≥
- [Supabase](https://supabase.com) –∑–∞ PostgreSQL —Å pgvector
- [pgvector](https://github.com/pgvector/pgvector) –∑–∞ –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è PostgreSQL

---

## üîÆ Roadmap

- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PDF —Ñ–∞–π–ª–æ–≤
- [ ] Multimodal embeddings (—Ç–µ–∫—Å—Ç + –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
- [ ] Fine-tuning GPT –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –¥–∏–∞–ª–æ–≥–æ–≤ –≤ Markdown/PDF
- [ ] API –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- [ ] Multi-user support —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
- [ ] Real-time collaboration
- [ ] Mobile app (React Native)

---

<div align="center">

**–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –∏—Å–ø–æ–ª—å–∑—É—è Next.js, OpenAI –∏ Supabase**

[‚¨Ü –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#-pierrot-ai)

</div>
