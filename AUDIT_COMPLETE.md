# โ ะะพะปะฝัะน ะฐัะดะธั ะธ ะพัะธััะบะฐ ะทะฐะฒะตััะตะฝั

## ะงัะพ ะฑัะปะพ ัะดะตะปะฐะฝะพ

### 1. โ ะัะฟัะฐะฒะปะตะฝ `/api/chat/route.ts`
**ะัะปะพ:**
- ะัะฟะพะปัะทะพะฒะฐะป HuggingFace API ะดะปั ะณะตะฝะตัะฐัะธะธ ะพัะฒะตัะพะฒ
- ะัะฟะพะปัะทะพะฒะฐะป ANON_KEY ะฒะผะตััะพ SERVICE_ROLE_KEY
- ะะฐะฒะธัะธะผะพััั ะพั ะฟะตัะตะผะตะฝะฝะพะน HF_API_KEY

**ะกัะฐะปะพ:**
- โ ะัะฟะพะปัะทัะตั OpenAI GPT-3.5-turbo ะดะปั ะณะตะฝะตัะฐัะธะธ ะพัะฒะตัะพะฒ
- โ ะัะฟะพะปัะทัะตั SERVICE_ROLE_KEY ะดะปั Supabase
- โ ะขะพะปัะบะพ OpenAI API KEY ััะตะฑัะตััั

### 2. โ ะัะธัะตะฝ `package.json`
**ะฃะดะฐะปะตะฝั ะทะฐะฒะธัะธะผะพััะธ:**
- โ `@huggingface/inference` (ะฑะพะปััะต ะฝะต ะฝัะถะตะฝ)
- โ `@xenova/transformers` (ะฑะพะปััะต ะฝะต ะฝัะถะตะฝ)
- โ `openai` (ะดัะฑะปะธะบะฐั, ะธัะฟะพะปัะทัะตััั ัะตัะตะท @ai-sdk/openai)
- โ `form-data` (ะฝะต ะธัะฟะพะปัะทัะตััั)
- โ `pg` (ะฝะต ะธัะฟะพะปัะทัะตััั ะฝะฐะฟััะผัั)

**ะััะฐะฒะปะตะฝั ัะพะปัะบะพ ะฝะตะพะฑัะพะดะธะผัะต:**
- โ `@ai-sdk/openai` - ะดะปั embeddings
- โ `ai` - Vercel AI SDK
- โ `@supabase/supabase-js` - ะฑะฐะทะฐ ะดะฐะฝะฝัั
- โ `axios` - ะดะปั HTTP ะทะฐะฟัะพัะพะฒ
- โ `cheerio` - ะดะปั ะฟะฐััะธะฝะณะฐ HTML
- โ `youtube-transcript` - ะดะปั YouTube
- โ `next`, `react`, `react-dom` - ััะตะนะผะฒะพัะบ
- โ `react-icons` - ะธะบะพะฝะบะธ

### 3. โ ะฃะดะฐะปะตะฝั ัััะฐัะตะฒัะธะต ัะฐะนะปั
- โ `test-embedding.js` (ัะตััั HuggingFace)
- โ `OLLAMA_SETUP.md` (ะดะพะบัะผะตะฝัะฐัะธั Ollama)
- โ `VERCEL_SETUP.md` (ัััะฐัะตะฒัะฐั ะดะพะบัะผะตะฝัะฐัะธั)
- โ `VERCEL_AI_ANALYSIS.md` (ัััะฐัะตะฒัะธะน ะฐะฝะฐะปะธะท)
- โ `MIGRATION_CHECKLIST.md` (ัะถะต ะฒัะฟะพะปะฝะตะฝะฐ ะผะธะณัะฐัะธั)

### 4. โ ะัะพะฒะตัะตะฝั ะฒัะต API routes

#### `/api/chat` โ
- Embeddings: OpenAI text-embedding-3-small (1536d)
- LLM: OpenAI GPT-3.5-turbo
- Database: Supabase ั SERVICE_ROLE_KEY
- Error handling: โ ะะพะปะฝะฐั ะพะฑัะฐะฑะพัะบะฐ

#### `/api/ingest` โ
- Embeddings: OpenAI ัะตัะตะท getEmbeddings()
- Chunking: splitIntoChunks()
- Database: Supabase ั SERVICE_ROLE_KEY
- Metadata: ะะพะปะฝะฐั ะธะฝัะพัะผะฐัะธั ะพ ัะฐะนะปะต

#### `/api/process` โ
- Embeddings: OpenAI ัะตัะตะท getEmbedding()
- ะะพะดะดะตัะถะบะฐ: YouTube + ะฒะตะฑ-ัััะฐะฝะธัั
- Database: Supabase ั SERVICE_ROLE_KEY
- Error handling: ะะพ ะบะฐะถะดะพะผั ัะฐะฝะบั

#### `/api/documents` โ
- Database: Supabase ั SERVICE_ROLE_KEY
- Joins: document_chunks
- Error handling: Try-catch ะฑะปะพะบะธ

### 5. โ ะะพะผะฟะพะฝะตะฝัั UI ะฟัะพะฒะตัะตะฝั

#### `ChatAssistant.tsx` โ
- ะฃะฟัะพััะฝะฝัะน ะธะฝัะตััะตะนั ะฑะตะท ะฒัะฑะพัะฐ ะผะพะดะตะปะตะน
- ะงะธัััะน ะดะธะทะฐะนะฝ
- ะะพััะตะบัะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ

#### `FileUploader.tsx` โ
- ะกัะฐัััั: idle โ uploading โ success/error
- ะะธะทัะฐะปัะฝัะต ะธะฝะดะธะบะฐัะพัั
- ะะตัะฐะปะธ ัะตะทัะปััะฐัะฐ

#### `LinkProcessor.tsx` โ
- ะะฐะปะธะดะฐัะธั URL
- ะัะพะณัะตัั ะฟะพ ะบะฐะถะดะพะน ัััะปะบะต
- ะะตัะฐะปัะฝัะต ัะตะทัะปััะฐัั

#### `DocumentsTable.tsx` โ
- ะะฐะณััะทะบะฐ ะธะท `/api/documents`
- ะัะพะฑัะฐะถะตะฝะธะต chunks
- ะฃะดะฐะปะตะฝะธะต ะดะพะบัะผะตะฝัะพะฒ

## ะขะตะบััะฐั ะฐััะธัะตะบัััะฐ (ัะพะปัะบะพ OpenAI)

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         Frontend (Next.js 14)           โ
โ  - ChatAssistant                        โ
โ  - FileUploader                         โ
โ  - LinkProcessor                        โ
โโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโ
                โ
                โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          API Routes (Node.js)           โ
โ                                         โ
โ  /api/chat                              โ
โ  โโ OpenAI embeddings (1536d)          โ
โ  โโ OpenAI GPT-3.5-turbo               โ
โ                                         โ
โ  /api/ingest                            โ
โ  โโ OpenAI embeddings (1536d)          โ
โ                                         โ
โ  /api/process                           โ
โ  โโ OpenAI embeddings (1536d)          โ
โโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโ
                โ
                โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      Supabase PostgreSQL + pgvector     โ
โ  - documents                            โ
โ  - document_chunks (vector 1536)        โ
โ  - match_documents() RPC                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั (ัะธะฝะฐะปัะฝัะน ัะฟะธัะพะบ)

### ะะฑัะทะฐัะตะปัะฝัะต
```bash
# OpenAI (ะตะดะธะฝััะฒะตะฝะฝัะน ะฟัะพะฒะฐะนะดะตั)
OPENAI_API_KEY=sk-proj-...

# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://...
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJ...
SUPABASE_SERVICE_ROLE_KEY=eyJ...

# Application
DEFAULT_SOURCE_ID=c5aab739-...
BASIC_AUTH_USER=admin
BASIC_AUTH_PASS=mylove2025
```

### ะฃะดะฐะปะตะฝั (ะฑะพะปััะต ะฝะต ะฝัะถะฝั)
```bash
โ HF_API_KEY
โ HUGGINGFACE_API_KEY
โ VOYAGE_API_KEY
โ COHERE_API_KEY
โ FIREWORKS_API_KEY
โ MIXEDBREAD_API_KEY
โ OLLAMA_BASE_URL
โ OLLAMA_MODEL
โ EMBEDDING_PROVIDER
โ USE_MOCK_EMBEDDINGS
โ MISTRAL_API_KEY
โ GEMINI_API_KEY
โ GROQ_API_KEY
โ VERCEL_API_KEY
```

## ะกัะพะธะผะพััั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### OpenAI Pricing
- **Embeddings** (text-embedding-3-small): $0.02 / 1M ัะพะบะตะฝะพะฒ
- **Chat** (gpt-3.5-turbo): $0.50 / 1M input + $1.50 / 1M output

### ะัะธะผะตั ัะฐััััะฐ
ะัะธ ะทะฐะณััะทะบะต 100 ะดะพะบัะผะตะฝัะพะฒ ะฟะพ 5000 ัะปะพะฒ:
- Embeddings: ~0.67M ัะพะบะตะฝะพะฒ = **$0.013**
- Chat (100 ะทะฐะฟัะพัะพะฒ): ~0.2M input + 0.1M output = **$0.25**
- **ะัะพะณะพ: ~$0.26** ะทะฐ 100 ะดะพะบัะผะตะฝัะพะฒ ะธ 100 ะฒะพะฟัะพัะพะฒ

## ะะพัะพะฒะพ ะบ ะดะตะฟะปะพั! ๐

ะัะต ะบะพะผะฟะพะฝะตะฝัั ะฟัะพะฒะตัะตะฝั ะธ ะพะฟัะธะผะธะทะธัะพะฒะฐะฝั.
ะัะฟะพะปัะทัะตััั ัะพะปัะบะพ OpenAI API.
ะะพะด ัะธัััะน ะธ ะฟะพะดะดะตัะถะธะฒะฐะตะผัะน.
