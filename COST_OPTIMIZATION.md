# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞—Å—Ö–æ–¥–æ–≤ –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞

## –ë—é–¥–∂–µ—Ç: $5/–º–µ—Å—è—Ü
**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:** 1 (—Ç–æ–ª—å–∫–æ –≤—ã)  
**–î–æ–∫—É–º–µ–Ω—Ç–æ–≤:** 200-300  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å –≤–∞—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

---

## üí∞ –†–∞—Å—á–µ—Ç —Ç–µ–∫—É—â–∏—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤

### 1. Embeddings (–æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ)
```
–î–æ–∫—É–º–µ–Ω—Ç–æ–≤: 200-300
–ß–∞–Ω–∫–æ–≤ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç: ~5-10 (–≤ —Å—Ä–µ–¥–Ω–µ–º 7)
–í—Å–µ–≥–æ —á–∞–Ω–∫–æ–≤: 200 √ó 7 = 1,400 - 300 √ó 10 = 3,000

–¢–æ–∫–µ–Ω–æ–≤ –Ω–∞ —á–∞–Ω–∫: ~500 (—Å—Ä–µ–¥–Ω–µ–µ)
–í—Å–µ–≥–æ —Ç–æ–∫–µ–Ω–æ–≤: 1,400 √ó 500 = 700k - 3,000 √ó 500 = 1.5M

–ú–æ–¥–µ–ª—å: text-embedding-3-small
–°—Ç–æ–∏–º–æ—Å—Ç—å: $0.02 / 1M tokens

–†–∞—Å—á–µ—Ç: 1.5M √ó $0.02/1M = $0.03 –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ
```
**Embeddings: $0.03 (–æ–¥–∏–Ω —Ä–∞–∑)**

### 2. GPT-4o-mini –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ (–µ–∂–µ–º–µ—Å—è—á–Ω–æ)
```
–ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å: 30-50 (–∞–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
–ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–µ—Å—è—Ü: 1,000-1,500

–¢–æ–∫–µ–Ω–æ–≤ –Ω–∞ –∑–∞–ø—Ä–æ—Å:
  - Input: ~2,000 tokens (–∫–æ–Ω—Ç–µ–∫—Å—Ç + –∑–∞–ø—Ä–æ—Å)
  - Output: ~500 tokens (–æ—Ç–≤–µ—Ç)
  - –ò—Ç–æ–≥–æ: 2,500 tokens/–∑–∞–ø—Ä–æ—Å

–°—Ç–æ–∏–º–æ—Å—Ç—å GPT-4o-mini:
  - Input: $0.150 / 1M tokens
  - Output: $0.600 / 1M tokens

–†–∞—Å—á–µ—Ç –¥–ª—è 1,000 –∑–∞–ø—Ä–æ—Å–æ–≤:
  Input: 1,000 √ó 2,000 = 2M tokens ‚Üí 2 √ó $0.15 = $0.30
  Output: 1,000 √ó 500 = 0.5M tokens ‚Üí 0.5 √ó $0.60 = $0.30
  
–ò—Ç–æ–≥–æ: $0.60/–º–µ—Å—è—Ü
```
**GPT-4o-mini: $0.60/–º–µ—Å—è—Ü**

### 3. Reranking (–ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏)
```
–°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥: –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å ‚Üí $0.53/–º–µ—Å—è—Ü ‚ùå
–ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥: —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ similarity < 0.5

–û–∂–∏–¥–∞–µ–º–∞—è —á–∞—Å—Ç–æ—Ç–∞ reranking: 20-30% –∑–∞–ø—Ä–æ—Å–æ–≤
  (–±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–º–µ—é—Ç –≤—ã—Å–æ–∫—É—é similarity)

–ó–∞–ø—Ä–æ—Å–æ–≤ —Å reranking: 1,000 √ó 0.25 = 250
–¢–æ–∫–µ–Ω–æ–≤ –Ω–∞ rerank: ~3,500 (7 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ √ó 500 tokens)

Input: 250 √ó 3,500 = 875k tokens ‚Üí $0.13
Output: 250 √ó 100 = 25k tokens ‚Üí $0.02

–ò—Ç–æ–≥–æ: $0.15/–º–µ—Å—è—Ü (–≤–º–µ—Å—Ç–æ $0.53)
```
**Reranking: $0.15/–º–µ—Å—è—Ü** (—ç–∫–æ–Ω–æ–º–∏—è $0.38)

### 4. Supabase
```
Plan: Free tier
  - 500 MB database
  - 1 GB file storage
  - 2 GB bandwidth
  - 500k Edge Function invocations

–í–∞—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
  - 3,000 —á–∞–Ω–∫–æ–≤ √ó 1kb = ~3 MB (–≤–µ–∫—Ç–æ—Ä—ã + —Ç–µ–∫—Å—Ç)
  - –ó–∞–ø—Ä–æ—Å–æ–≤: ~1,000/–º–µ—Å—è—Ü = 1k invocations
  
–°—Ç–∞—Ç—É—Å: –ü–æ–ª–Ω–æ—Å—Ç—å—é –≤ Free tier ‚úÖ
```
**Supabase: $0/–º–µ—Å—è—Ü**

### 5. Vercel
```
Plan: Hobby (Free)
  - 100 GB bandwidth
  - 100 GB-hours serverless execution
  
–í–∞—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
  - ~1,000 API calls/–º–µ—Å—è—Ü
  - ~2-3 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ –∑–∞–ø—Ä–æ—Å = 3,000 —Å–µ–∫—É–Ω–¥ = 0.83 —á–∞—Å–∞
  
–°—Ç–∞—Ç—É—Å: –ü–æ–ª–Ω–æ—Å—Ç—å—é –≤ Free tier ‚úÖ
```
**Vercel: $0/–º–µ—Å—è—Ü**

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–æ–∏–º–æ—Å—Ç—å | –ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å |
|-----------|-----------|---------------|
| Embeddings | $0.03 | –û–¥–∏–Ω —Ä–∞–∑ (–ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ) |
| GPT-4o-mini | $0.60 | –ï–∂–µ–º–µ—Å—è—á–Ω–æ |
| Reranking (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π) | $0.15 | –ï–∂–µ–º–µ—Å—è—á–Ω–æ |
| Supabase | $0.00 | Free tier |
| Vercel | $0.00 | Free tier |
| **–ò–¢–û–ì–û** | **$0.78/–º–µ—Å—è—Ü** | **–ï–∂–µ–º–µ—Å—è—á–Ω–æ** |

**–ó–∞–ø–∞—Å –æ—Ç –±—é–¥–∂–µ—Ç–∞:** $5.00 - $0.78 = **$4.22** ‚úÖ

---

## üéØ –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. ‚úÖ Conditional Reranking
**–ë—ã–ª–æ:** Reranking –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å  
**–°—Ç–∞–ª–æ:** –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ `topSimilarity < 0.5`  
**–≠–∫–æ–Ω–æ–º–∏—è:** $0.38/–º–µ—Å—è—Ü (70% —Å–Ω–∏–∂–µ–Ω–∏–µ)

```typescript
// app/api/chat/route.ts
const shouldRerank = matches && matches.length > 0 && 
                     intent.action === 'qa' && 
                     topSimilarity < 0.5;  // –¢–æ–ª—å–∫–æ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
```

### 2. ‚úÖ –û—Ç–∫–∞–∑ –æ—Ç Fine-tuning
**–ë—ã–ª–æ:** Fine-tuned –º–æ–¥–µ–ª—å  
**–°—Ç–æ–∏–º–æ—Å—Ç—å fine-tuning:** $0.60-1.20 –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ + –¥–æ—Ä–æ–≥–æ–π inference  
**–°—Ç–∞–ª–æ:** GPT-4o-mini —Å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏  
**–≠–∫–æ–Ω–æ–º–∏—è:** ~$2-3/–º–µ—Å—è—Ü

**–ü—Ä–∏—á–∏–Ω–∞:** –î–ª—è 1 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è fine-tuning –Ω–µ –æ–ø—Ä–∞–≤–¥–∞–Ω. GPT-4o-mini —Å —Ö–æ—Ä–æ—à–∏–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏ –¥–∞–µ—Ç 95% –∫–∞—á–µ—Å—Ç–≤–∞ –∑–∞ 10% —Å—Ç–æ–∏–º–æ—Å—Ç–∏.

### 3. ‚úÖ –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è Telemetry
**–ë—ã–ª–æ:** SessionStats, RateLimiter, –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏  
**–°—Ç–∞–ª–æ:** –¢–æ–ª—å–∫–æ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ + –∞–ª–µ—Ä—Ç—ã –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã  
**–≠–∫–æ–Ω–æ–º–∏—è:** –ù–µ—Ç –ø—Ä—è–º–æ–π —ç–∫–æ–Ω–æ–º–∏–∏, –Ω–æ —É–ø—Ä–æ—â–µ–Ω–∏–µ –∫–æ–¥–∞

```typescript
// lib/telemetry.ts - –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –ª–æ–≥
console.log(`[METRICS] ${grade} | ${intent} | sim:${similarity} | ${latency}ms`);

// JSON —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã
if (quality < 0.5 || latency > 5000) {
  console.warn('[METRICS:LOW_QUALITY]', JSON.stringify(metrics));
}
```

### 4. ‚úÖ Batch Embedding —Å –ª–∏–º–∏—Ç–∞–º–∏
**–ë—ã–ª–æ:** 50 —á–∞–Ω–∫–æ–≤ –∑–∞ —Ä–∞–∑  
**–°—Ç–∞–ª–æ:** 10 —á–∞–Ω–∫–æ–≤ –∑–∞ —Ä–∞–∑  
**–ü—Ä–∏—á–∏–Ω–∞:** –ò–∑–±–µ–≥–∞–Ω–∏–µ timeout –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤

```typescript
// lib/embedding-ai.ts
const BATCH_SIZE = 10; // –£–º–µ–Ω—å—à–µ–Ω–æ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
```

---

## üöÄ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–∞–ª—å–Ω–µ–π—à–µ–π —ç–∫–æ–Ω–æ–º–∏–∏

1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤**
   - –ï—Å–ª–∏ –≤—ã —á–∞—Å—Ç–æ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç–µ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ, –º–æ–∂–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã
   - –≠–∫–æ–Ω–æ–º–∏—è: –¥–æ 30% –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
   - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è: Redis/Upstash (Free tier 10k commands/day)

2. **–°–∂–∞—Ç–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –∫–æ–º–ø–∞–∫—Ç–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —á–∞–Ω–∫–æ–≤
   - Summarization –¥–ª–∏–Ω–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ LLM
   - –≠–∫–æ–Ω–æ–º–∏—è: 20-30% —Ç–æ–∫–µ–Ω–æ–≤

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ gpt-3.5-turbo –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤**
   - –î–µ—à–µ–≤–ª–µ –≤ 3-4 —Ä–∞–∑–∞: $0.50/1M input, $1.50/1M output
   - –î–ª—è –ø—Ä–æ—Å—Ç—ã—Ö "–Ω–∞–π–¥–∏ –¥–æ–∫—É–º–µ–Ω—Ç" –∑–∞–ø—Ä–æ—Å–æ–≤ –≤–ø–æ–ª–Ω–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
   - –≠–∫–æ–Ω–æ–º–∏—è: –¥–æ 40% –Ω–∞ –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö

4. **Lazy embedding –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**
   - –ù–µ —ç–º–±–µ–¥–∏—Ç—å –≤—Å–µ —Å—Ä–∞–∑—É, –∞ –ø–æ –º–µ—Ä–µ –æ–±—Ä–∞—â–µ–Ω–∏—è
   - –ï—Å–ª–∏ —É –≤–∞—Å 300 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –∞–∫—Ç–∏–≤–Ω–æ 50
   - –≠–∫–æ–Ω–æ–º–∏—è –Ω–∞ embeddings: 80%

---

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (–µ—Å–ª–∏ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è)

### –ü—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–æ $5/–º–µ—Å—è—Ü:

**–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ë–º–∫–æ—Å—Ç—å:**
- –î–æ–∫—É–º–µ–Ω—Ç–æ–≤: **500-700** (—Å —Ç–µ–∫—É—â–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏)
- –ó–∞–ø—Ä–æ—Å–æ–≤: **6,000-7,000/–º–µ—Å—è—Ü** (~200/–¥–µ–Ω—å)
- Reranking: –ú–æ–∂–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∏—Ç—å –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏

**–ö–æ–≥–¥–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ –ø–ª–∞—Ç–Ω—ã–π plan:**
- Supabase Pro ($25/–º–µ—Å): –ö–æ–≥–¥–∞ –ë–î > 500 MB –∏–ª–∏ –Ω—É–∂–Ω—ã backups
- Vercel Pro ($20/–º–µ—Å): –ö–æ–≥–¥–∞ bandwidth > 100 GB
- –ù–µ —Å—Ç–æ–∏—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –ø—Ä–∏ –≤–∞—à–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏!

---

## üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ—Ä–∞—Å—Ö–æ–¥–∞

### –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ OpenAI Dashboard:

1. **Hard limit:** $10/–º–µ—Å—è—Ü (–∞–≤—Ç–æ—Å—Ç–æ–ø)
2. **Soft limit:** $5/–º–µ—Å—è—Ü (email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ)
3. **Usage notifications:** Email –ø—Ä–∏ 50%, 75%, 90%

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ OpenAI
curl https://api.openai.com/v1/usage \
  -H "Authorization: Bearer $OPENAI_API_KEY"

# –ò–ª–∏ —á–µ—Ä–µ–∑ dashboard:
# https://platform.openai.com/usage
```

---

## üìù –í—ã–≤–æ–¥—ã

‚úÖ **–¢–µ–∫—É—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã:** $0.78/–º–µ—Å—è—Ü  
‚úÖ **–ó–∞–ø–∞—Å –æ—Ç –±—é–¥–∂–µ—Ç–∞:** $4.22 (84% —Å–≤–æ–±–æ–¥–Ω–æ)  
‚úÖ **–í—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã**  
‚úÖ **Supabase –∏ Vercel –≤ Free tier**  

–°–∏—Å—Ç–µ–º–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∑–∞—Ç—Ä–∞—Ç–∞–º–∏ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ high quality.

**–ú–æ–∂–Ω–æ —Å–ø–æ–∫–æ–π–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å!** üéâ
